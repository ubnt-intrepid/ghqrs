box: tomaka/rust-android-docker

build:
  steps:
    - script:
        name: Install dependencies
        code: |
          sudo apt-get install -y python

    - script:
        name: install standard toolchain
        code: |
          $NDK_HOME/build/tools/make_standalone_toolchain.py --arch arm --api 23 --install-dir $HOME/my-android-toolchain
          echo "[target.arm-linux-androideabi]" > $HOME/.cargo/config
          echo "linker = \"$HOME/my-android-toolchain/bin/arm-linux-androideabi-gcc\"" >> $HOME/.cargo/config

    - script:
        name: show version
        code: |
          ls -al
          echo $PATH
          cargo -V
          python --version

    - script:
        name: build and package the target
        code: |
          bash ./ci/make_package.sh
